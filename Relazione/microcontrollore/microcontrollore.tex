\pagebreak
\section{Microcontrollore}
Un microcontrollore è un dispositivo elettronico programmabile con al suo interno un microprocessore e altre funzionalità utili per il controllo di sistemi elettronici.\\
Il microcontrollore usato  è il NUCLEO H743ZI2 ed è stato usato il programma dato dalla fabbrica produttrice, STM.\\
\subsection{Funzionamento generale}
\subsubsection{Struttura interna}
Il $\mu$ - controllore usato sfrutta la struttura interna di Harvard. La memoria del microcontrollore è quindi divisa in due parti: una per le istruzioni e una per i dati. Con l'ulteriore suddivisione della memoria, questa struttura è più costosa di quella standard sia in termini di costo che in termini di energia in quanto ogni parte che collega la CPU alla memoria deve essere duplicata e la CPU deve essere in grado di gestire due bus di memoria.\\
\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\linewidth]{microcontrollore/assets/Harvard.png}
    \caption{Struttura interna del microcontrollore}
\end{figure}
Questa architettura, unita ad un doppio bus asincrono, permette di eseguire più operazioni in parallelo, aumentando la velocità di esecuzione. Un esempio del perchè questa architettura sia più veloce deriva dal fatto che in un singolo colpo di clock, il microcontrollore sia in grado di leggere l'istruzione e interagire con il dato da modificare.\\

\subsubsection{Memoria}
All'interno del microcontrollore esistono 3 tipi di memoria:
\begin{itemize}
    \item Flash: Una memoria non volatile che sacrifica la velocità di scrittura per aumentare la capacità di lettura. Nei microcontrollori è usata per salvare i programmi.
    \item RAM: Una memoria volatile con lo scopo di salvare i dati della singola esecuzione del programma. Per stare al passo con la CPU serve velocità di lettura e scrittura
    \item ROM: Una memoria non volatile di sola lettura. Viene scritta dai produttori e contiene informazioni fondamentali per il corretto funzionamento del microcontrollore, oltre alla definizione di registri e celle di memoria speciale.
\end{itemize}
Ogni memoria è divisa in celle, ognuna delle dimensioni di un byte e caratterizzata da un indirizzo unico. Per salvare dati più grandi di un byte, si usano più celle contigue, così che sapendo dimensione del dato e indirizzo di partenza, si possa trovare univocamente il dato.\\
La memoria è connessa alla CPU con dei BUS dedicati.

Per quanto riguarda la RAM, oltre ad essere divisa in celle, i produttori della scheda dividono la memoria dedicata alle periferiche in registri. Dandogli dei ruoli specifici all'interno della CPU. Questa divisione permette di avere un modo più semplice di collegare le celle di memoria al loro significato e permette alla CPU di lavorare in maniera più efficiente sulle celle di memoria a utilizzi speciali.

Nella memoria Flash, invece, i programmi sono salvati in pile di celle di memoria, ognuna con un codice operativo che, letto dalla CPU, si trasforma in un'istruzione. L'istruzione in questione non ha accesso solo alla RAM in cui sono contenuti i dati di esecuzione ma anche alla memoria flash stessa; questo permette alla CPU di saltare istruzioni o di ripeterle nel caso in cui sia richiesto.



\subsection{Periferiche}

Il microcontrollore è dotato di diverse periferiche e funzionalità ma noi siamo andati a guardare solo quelle interessanti allo scopo di trattare dati analogici e digitali. Queste funzionalità sono:
\begin{itemize}
    \item Timer
    \item Universal Synchronous Asynchronous Receiver Transmitter (USART)
    \item Analog Digital Converter (ADC)
    \item Direct Memory Access (DMA)
    \item Digital Analog Converter (DAC)
    \item Comparatore
\end{itemize}
In particolare, USART è utile per trasmettere dati al computer con la seriale, l'ADC per leggere dati analogici, il timer per triggerare il tempo tra una misura e l'altra in modo da avere misure equidistanti, il DMA per trasferire i dati tra la memoria e le periferiche senza l'intervento della CPU e il DAC e il comparatore per creare dei meccanismi di trigger hardware.



\input{microcontrollore/programmazione.tex}

\input{microcontrollore/USART.tex}

\input{microcontrollore/ADC.tex}

\input{microcontrollore/DMA.tex}

\input{microcontrollore/timer.tex}

\input{microcontrollore/DAC.tex}